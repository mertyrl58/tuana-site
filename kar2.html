<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tuanya'ya Özel ❤️</title>

  <style>
    /* ANA TEMA: KIŞ & NEON */
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      flex-direction: column;
      align-items:center;
      justify-content:center;
      font-family: Arial, Helvetica, sans-serif;
      background:
        radial-gradient(900px 500px at 20% 10%, rgba(124,77,255,.28), transparent 60%),
        radial-gradient(900px 500px at 80% 30%, rgba(0,212,255,.20), transparent 60%),
        #05060f;
      overflow:hidden;
      color:#e8ecff;
    }

    .wrap{
      position:relative;
      z-index:5;
      width:min(980px,92vw);
      padding:26px 22px;
      border-radius:26px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      box-shadow: 0 22px 80px rgba(0,0,0,.55);
      text-align:center;
    }

    .neon{
      margin:0;
      font-size: clamp(35px, 5vw, 70px);
      letter-spacing: 2px;
      font-weight: 900;
      background: linear-gradient(90deg, #7c4dff, #00d4ff);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      animation: pulse 1.1s infinite ease-in-out;
    }

    @keyframes pulse{
      0%,100%{ filter: brightness(1.05); opacity: 1; }
      50%{ filter: brightness(1.45); opacity: .82; }
    }

    /* OYUN ALANI */
    #game-box {
      position: relative;
      margin-top: 15px;
      border-top: 1px solid rgba(255,255,255,0.1);
      padding-top: 15px;
    }

    .stats {
      display: flex;
      justify-content: space-around;
      margin-bottom: 10px;
      font-size: 18px;
      font-weight: bold;
      color: #00d4ff;
    }

    #gameCanvas {
      background: rgba(0, 0, 0, 0.4);
      border-radius: 15px;
      border: 1px solid rgba(124,77,255,0.4);
      cursor: crosshair;
      touch-action: none; /* Mobil kaydırmayı engeller */
    }

    .btn-restart {
      display: none;
      position: absolute;
      top: 60%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 12px 24px;
      background: linear-gradient(90deg, #7c4dff, #00d4ff);
      border: none;
      border-radius: 50px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 0 15px rgba(124,77,255,0.6);
      z-index: 10;
    }

    #snow{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:2;
    }
  </style>
</head>

<body>
  <canvas id="snow"></canvas>

  <div class="wrap">
    <h1 class="neon" id="main-title">SEVİYOM SENİ</h1>
    <p style="color:rgba(255,255,255,0.5); font-size: 13px; margin: 5px 0;">GAMAMERT | TUANYA ❤️</p>

    <div id="game-box">
      <div class="stats">
        <div>Süre: <span id="time">30</span>s</div>
        <div>Puan: <span id="score">0</span></div>
      </div>
      
      <canvas id="gameCanvas" width="350" height="250"></canvas>
      <button class="btn-restart" id="restartBtn" onclick="resetGame()">Tekrar Dene</button>
      
      <p id="hint-text" style="font-size: 12px; margin-top: 8px; color: rgba(255,255,255,0.4);">
        Düşen kalpleri yakala!
      </p>
    </div>
  </div>

  <script>
    // 1. KAR ANİMASYONU
    const snowCanvas = document.getElementById("snow");
    const sCtx = snowCanvas.getContext("2d");
    let sw, sh, flakes = [];

    function resizeSnow() {
      sw = snowCanvas.width = window.innerWidth;
      sh = snowCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeSnow);
    resizeSnow();

    function initSnow() {
      flakes = [];
      for(let i=0; i<100; i++) {
        flakes.push({
          x: Math.random()*sw, y: Math.random()*sh,
          r: 1 + Math.random()*2, v: 0.5 + Math.random()*1.5,
          d: -0.5 + Math.random()*1, a: 0.3 + Math.random()*0.5
        });
      }
    }
    initSnow();

    function drawSnow() {
      sCtx.clearRect(0,0,sw,sh);
      sCtx.fillStyle = "#fff";
      for(const f of flakes){
        sCtx.globalAlpha = f.a;
        sCtx.beginPath();
        sCtx.arc(f.x, f.y, f.r, 0, Math.PI*2);
        sCtx.fill();
        f.y += f.v; f.x += f.d;
        if(f.y > sh) f.y = -10;
      }
      requestAnimationFrame(drawSnow);
    }
    drawSnow();

    // 2. KALP YAKALAMA OYUNU SİSTEMİ
    const gCanvas = document.getElementById("gameCanvas");
    const gCtx = gCanvas.getContext("2d");
    let score = 0;
    let timeLeft = 30;
    let hearts = [];
    let gameActive = true;
    let timerInterval;

    function createHeart() {
      return {
        x: Math.random() * (gCanvas.width - 30) + 15,
        y: -30,
        speed: 0.8 + Math.random() * 1.2, // Kalpler artık daha yavaş (0.8 - 2.0 arası)
        size: 20 + Math.random() * 10,
        color: `hsl(${Math.random() * 30 + 330}, 80%, 65%)` // Pembe-Kırmızı tonları
      };
    }

    function drawHeart(x, y, size, color) {
      gCtx.fillStyle = color;
      gCtx.shadowBlur = 8;
      gCtx.shadowColor = color;
      gCtx.beginPath();
      gCtx.moveTo(x, y + size / 4);
      gCtx.quadraticCurveTo(x, y, x + size / 4, y);
      gCtx.quadraticCurveTo(x + size / 2, y, x + size / 2, y + size / 4);
      gCtx.quadraticCurveTo(x + size / 2, y, x + size * 3/4, y);
      gCtx.quadraticCurveTo(x + size, y, x + size, y + size / 4);
      gCtx.quadraticCurveTo(x + size, y + size / 2, x + size * 3/4, y + size * 3/4);
      gCtx.lineTo(x + size / 2, y + size);
      gCtx.lineTo(x + size / 4, y + size * 3/4);
      gCtx.quadraticCurveTo(x, y + size / 2, x, y + size / 4);
      gCtx.fill();
      gCtx.shadowBlur = 0;
    }

    function handleInput(e) {
      if(!gameActive) return;
      const rect = gCanvas.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      const mouseX = clientX - rect.left;
      const mouseY = clientY - rect.top;

      for (let i = hearts.length - 1; i >= 0; i--) {
        let h = hearts[i];
        // Tıklama alanı tespiti
        if (mouseX > h.x - 15 && mouseX < h.x + h.size + 15 &&
            mouseY > h.y - 15 && mouseY < h.y + h.size + 15) {
          hearts.splice(i, 1);
          score++;
          document.getElementById("score").innerText = score;
        }
      }
    }

    gCanvas.addEventListener("mousedown", handleInput);
    gCanvas.addEventListener("touchstart", (e) => { e.preventDefault(); handleInput(e); });

    function startTimer() {
      timerInterval = setInterval(() => {
        timeLeft--;
        document.getElementById("time").innerText = timeLeft;
        if(timeLeft <= 0) {
          endGame();
        }
      }, 1000);
    }

    function endGame() {
      gameActive = false;
      clearInterval(timerInterval);
      document.getElementById("restartBtn").style.display = "block";
      document.getElementById("hint-text").innerText = "Oyun Bitti! Harikasın Tuanya ❤️";
    }

    function resetGame() {
      score = 0;
      timeLeft = 30;
      hearts = [];
      gameActive = true;
      document.getElementById("score").innerText = "0";
      document.getElementById("time").innerText = "30";
      document.getElementById("restartBtn").style.display = "none";
      document.getElementById("hint-text").innerText = "Düşen kalpleri yakala!";
      clearInterval(timerInterval);
      startTimer();
    }

    function updateGame() {
      gCtx.clearRect(0, 0, gCanvas.width, gCanvas.height);
      
      if (gameActive) {
        if (Math.random() < 0.015) hearts.push(createHeart()); // Kalp çıkma sıklığı

        hearts.forEach((h, index) => {
          h.y += h.speed;
          drawHeart(h.x, h.y, h.size, h.color);
          if (h.y > gCanvas.height) hearts.splice(index, 1);
        });
      } else {
        gCtx.fillStyle = "white";
        gCtx.font = "20px Arial";
        gCtx.textAlign = "center";
        gCtx.fillText("Final Skoru: " + score, gCanvas.width/2, gCanvas.height/2);
      }

      requestAnimationFrame(updateGame);
    }

    // Başlat
    startTimer();
    updateGame();
  </script>
</body>
</html>